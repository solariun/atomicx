\hypertarget{avr_auto_robot_controller_8ino_source}{}\doxysection{avr\+Auto\+Robot\+Controller.\+ino}
\label{avr_auto_robot_controller_8ino_source}\index{examples/Arduino/avrAutoRobotController/avrAutoRobotController.ino@{examples/Arduino/avrAutoRobotController/avrAutoRobotController.ino}}
\mbox{\hyperlink{avr_auto_robot_controller_8ino}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00001}00001 /*}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00003}00003 */}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00005}00005 \#include "{}arduino.h"{}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00006}00006 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00007}00007 \#include "{}atomicx.hpp"{}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00008}00008 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00009}00009 \#include <stdio.h>}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00010}00010 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00011}00011 \#include <string.h>}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00012}00012 \#include <stdint.h>}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00013}00013 \#include <setjmp.h>}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00014}00014 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00015}00015 using namespace thread;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00016}00016 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00017}00017 size\_t nDataCount=0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00019}00019 // Used for accumulate the commands.}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00020}00020 String readCommand = "{}"{};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00022}00022 void ListAllThreads();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00024}00024 \#define PrintStackOverflow() \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00025}00025         Serial.print (\_\_FUNCTION\_\_); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00026}00026         Serial.print ("{}["{}); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00027}00027         Serial.print (GetName ()); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00028}00028         Serial.print (F("{}/"{})); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00029}00029         Serial.print ((size\_t) this); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00030}00030         Serial.print ("{}]:  StackSize: ["{}); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00031}00031         Serial.print (GetStackSize ()); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00032}00032         Serial.print ("{}]. Stack used ["{}); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00033}00033         Serial.print (GetUsedStackSize()); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00034}00034         Serial.println (F("{}]"{})); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00035}00035         Serial.flush(); \(\backslash\)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00038}00038 // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00040}00040 size\_t GetFreeRam () \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00041}00041   extern int \_\_heap\_start, *\_\_brkval;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00042}00042   int v;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00043}00043   return (int) \&v -\/ (\_\_brkval == 0 ? (int) \&\_\_heap\_start : (int) \_\_brkval);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00044}00044 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00046}00046 atomicx\_time Atomicx\_GetTick(void)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00047}00047 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00048}00048     ::yield();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00049}00049     return millis();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00050}00050 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00052}00052 void Atomicx\_SleepTick(atomicx\_time nSleep)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00053}00053 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00054}00054     delay(nSleep);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00055}00055 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00056}00056 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00057}00057 constexpr size\_t GetStackSize(size\_t sizeRef)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00058}00058 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00059}00059     return sizeRef * sizeof (size\_t);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00060}00060 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00062}00062 // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00064}00064 uint8\_t ParseOption (const String\& commandLine, uint8\_t nCommandIndex, String\& returnText, bool countOnly=false)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00065}00065 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00066}00066     uint8\_t nCommandOffSet = 0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00068}00068     nCommandIndex++;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00070}00070     enum class state : uint8\_t}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00071}00071     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00072}00072         NoText,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00073}00073         Word,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00074}00074         Text,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00075}00075     \} currentState;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00077}00077     currentState = state::NoText;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00078}00078     returnText = "{}"{};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00079}00079 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00080}00080     bool boolScape = false;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00082}00082     String strBuffer="{}"{};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00083}00083 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00084}00084     for (char chChar : commandLine)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00085}00085     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00086}00086         if (currentState == state::NoText)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00087}00087         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00088}00088             if (chChar == '"{}' || chChar == '\(\backslash\)'')}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00089}00089             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00090}00090                 // set Text state}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00091}00091                 currentState = state::Text;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00092}00092                 nCommandOffSet++;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00093}00093                 continue;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00094}00094             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00095}00095             else if (chChar != ' ')}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00096}00096             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00097}00097                 // Set Word state}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00098}00098                 currentState = state::Word;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00099}00099                 nCommandOffSet++;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00100}00100             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00101}00101         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00103}00103         if (currentState != state::NoText)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00104}00104         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00105}00105             if (boolScape == false)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00106}00106             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00107}00107                 if (currentState == state::Text \&\& chChar == '"{}' || chChar == '\(\backslash\)'')}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00108}00108                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00109}00109                     currentState = state::NoText;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00110}00110                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00111}00111                 else if (currentState == state::Word \&\& chChar == ' ')}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00112}00112                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00113}00113                     currentState = state::NoText;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00114}00114                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00115}00115                 if (chChar == '\(\backslash\)\(\backslash\)')}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00116}00116                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00117}00117                     boolScape = true;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00118}00118                     strBuffer.remove(0, strBuffer.length());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00119}00119                     continue;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00120}00120                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00121}00121             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00122}00122             else if (!isdigit (chChar))}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00123}00123             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00124}00124                 boolScape = false;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00125}00125             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00126}00126 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00127}00127             if (currentState == state::NoText)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00128}00128             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00129}00129                 if (countOnly == false \&\& nCommandIndex == nCommandOffSet)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00130}00130                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00131}00131                     break;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00132}00132                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00133}00133 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00134}00134                 returnText.remove(0,returnText.length());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00135}00135             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00136}00136             else}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00137}00137             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00138}00138                 if (countOnly == false)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00139}00139                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00140}00140                     if (boolScape == true and isdigit (chChar))}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00141}00141                     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00142}00142                         strBuffer += chChar;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00143}00143                     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00144}00144                     else}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00145}00145                     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00146}00146                         // To add special char \(\backslash\)000\(\backslash\) 00 = number only}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00147}00147                         if (strBuffer.length () > 0)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00148}00148                         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00149}00149                             returnText.concat (static\_cast<char> (atoi (strBuffer.c\_str ())));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00150}00150                             strBuffer.remove(0, strBuffer.length());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00151}00151                         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00152}00152                         else}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00153}00153                         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00154}00154                             returnText.concat (static\_cast<char>(chChar)); /* code */}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00155}00155                         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00156}00156                     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00157}00157                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00158}00158             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00159}00159         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00160}00160     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00161}00161 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00162}00162     if (nCommandIndex != nCommandOffSet)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00163}00163     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00164}00164         returnText = "{}"{};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00165}00165     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00166}00166 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00167}00167     return nCommandOffSet;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00168}00168 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00169}00169 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00170}00170 // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00171}00171 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00172}00172 // ==================== MOTOR DEFINITIONS ====================}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00173}00173 const int stepX = 2;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00174}00174 const int dirX  = 5;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00175}00175 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00176}00176 const int stepY = 3;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00177}00177 const int dirY  = 6;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00178}00178 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00179}00179 const int stepZ = 4;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00180}00180 const int dirZ  = 7;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00181}00181 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00182}00182 const int stepA = 12;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00183}00183 const int dirA = 13;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00184}00184 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00185}00185 const int enPin = 8;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00186}00186 //=============================================================}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00187}00187 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00188}00188 enum class MotorStatus}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00189}00189 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00190}00190     ready,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00191}00191     busy,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00192}00192     error,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00193}00193     disabled,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00194}00194     response,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00195}00195     request,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00196}00196     moveRequest,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00197}00197     moveComplete}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00198}00198 \};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00199}00199 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00200}00200 const uint8\_t motorsContext = 4;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00201}00201 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00202}00202 struct MotorData}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00203}00203 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00204}00204     MotorData(): encoder\{0\}, movement \{0\}, volts\{0\}, status\{MotorStatus::ready\}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00205}00205     \{\}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00206}00206 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00207}00207     float encoder;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00208}00208     float movement;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00209}00209     float volts;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00210}00210 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00211}00211     MotorStatus status;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00212}00212 \} g\_motors [motorsContext];}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00213}00213 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00214}00214 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00215}00215 void MoveMotor (struct MotorData\& motor, size\_t nDistance)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00216}00216 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00217}00217     (void) motor;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00218}00218 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00219}00219     while (nDistance-\/-\/)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00220}00220     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00221}00221         atomicx::GetCurrent()-\/>Yield (1);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00222}00222     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00223}00223 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00224}00224 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00225}00225 /**}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00226}00226  * @brief SERIAL COMM}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00227}00227  *}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00228}00228  */}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00229}00229 class Motor : public atomicx}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00230}00230 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00231}00231 public:}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00232}00232     Motor(uint32\_t nNice, char motorLetter, MotorData\& motor, int dirPin, int stepperPin) : atomicx (0, 10), m\_motor(motor), m\_directionPin(dirPin), m\_stepperPin(stepperPin)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00233}00233     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00234}00234         SetNice(nNice);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00235}00235 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00236}00236         // Setup output pins to control motor driver}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00237}00237         pinMode(stepperPin,OUTPUT);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00238}00238         pinMode(dirPin,OUTPUT);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00239}00239 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00240}00240         // Set Initial direction}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00241}00241         digitalWrite(dirPin,HIGH);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00242}00242 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00243}00243     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00244}00244 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00245}00245     const char* GetName () override}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00246}00246     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00247}00247         return "{}Motor"{};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00248}00248     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00249}00249 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00250}00250     \string~Motor()}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00251}00251     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00252}00252         Serial.print("{}Deleting "{});}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00253}00253         Serial.println ((size\_t) this);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00254}00254     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00256}00256     void run() noexcept override}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00257}00257     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00258}00258         size\_t nNotified=0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00259}00259         uint8\_t nCurrentMotor = ((size\_t)\&m\_motor -\/ (size\_t)\&g\_motors) / sizeof (struct MotorData);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00260}00260 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00261}00261         for (;;)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00262}00262         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00263}00263             Yield ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00264}00264 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00265}00265             size\_t nMessage = 0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00266}00266 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00267}00267             if (Wait (nMessage, motorsContext, (size\_t) MotorStatus::request, 100))}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00268}00268             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00269}00269                 Serial.print ("{}Motor "{}); Serial.print ((char) ('A' + nCurrentMotor));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00270}00270                 Serial.println ("{}:Notification received."{});}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00271}00271 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00272}00272                 if ((MotorStatus) nMessage == MotorStatus::moveRequest \&\& m\_motor.movement > 0)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00273}00273                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00274}00274                     // Processing Motor}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00275}00275                     Serial.print (F("{}Thread "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00276}00276                     Serial.print (GetID ());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00277}00277                     Serial.print (F("{}: Moving motor "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00278}00278                     Serial.print (m\_motor.movement);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00279}00279                     Serial.print (F("{} from: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00280}00280                     Serial.print (m\_motor.encoder);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00281}00281                     Serial.print (F("{}, to: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00282}00282                     Serial.print (m\_motor.movement + m\_motor.encoder);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00283}00283                     Serial.print (F("{}, moving:"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00284}00284                     Serial.println (m\_motor.movement);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00285}00285                     Serial.flush();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00286}00286 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00287}00287                     MoveMotor (m\_motor, m\_motor.movement);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00288}00288 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00289}00289                     m\_motor.encoder +=  m\_motor.movement;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00290}00290                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00292}00292                 if (SyncNotify ((size\_t) nCurrentMotor, motorsContext, (size\_t) MotorStatus::response, 1000) == 0)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00293}00293                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00294}00294                     Serial.print (F("{}ERROR Motor "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00295}00295                     Serial.print ((char) ('A' + nCurrentMotor));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00296}00296                     Serial.println (F("{}: System was not notified.\(\backslash\)n"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00297}00297                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00298}00298 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00299}00299                 Serial.flush ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00300}00300             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00301}00301 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00302}00302             m\_motor.volts = static\_cast<float>(random (2000, 2700)) / 100.0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00303}00303 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00304}00304         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00305}00305     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00306}00306 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00307}00307     void StackOverflowHandler(void) noexcept final}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00308}00308     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00309}00309         PrintStackOverflow ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00310}00310     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00311}00311 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00312}00312 private:}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00313}00313     struct MotorData\& m\_motor;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00314}00314     int m\_directionPin;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00315}00315     int m\_stepperPin;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00316}00316 \};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00317}00317 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00318}00318 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00319}00319 // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00320}00320 enum class terminalStatus : size\_t}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00321}00321 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00322}00322     command=10,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00323}00323     done,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00324}00324     status,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00325}00325     ok,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00326}00326     error}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00327}00327 \};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00328}00328 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00329}00329 enum class TerminalCommands : size\_t}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00330}00330 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00331}00331     none,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00332}00332     system,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00333}00333     move,}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00334}00334 \};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00335}00335 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00336}00336 uint8\_t ConvertStrCommand (String\& strCommand)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00337}00337 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00338}00338     TerminalCommands ret = TerminalCommands::none;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00339}00339 \#define IFCOMMAND(cmd) if (strCommand == \#cmd) ret = TerminalCommands::cmd}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00340}00340 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00341}00341     if (strCommand.length())}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00342}00342     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00343}00343         IFCOMMAND (system);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00344}00344         else IFCOMMAND (move);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00345}00345     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00346}00346 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00347}00347     return static\_cast<uint8\_t>(ret);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00348}00348 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00349}00349 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00350}00350 // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00352}00352 \#define TERMINAL\_BS 8}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00353}00353 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00354}00354 /**}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00355}00355  * @brief SERIAL COMM}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00356}00356  *}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00357}00357  */}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00358}00358 class Terminal : public atomicx}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00359}00359 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00360}00360 public:}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00361}00361     Terminal(uint32\_t nNice) : atomicx (0, 10)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00362}00362     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00363}00363         SetNice(nNice);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00364}00364     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00365}00365 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00366}00366     const char* GetName () override}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00367}00367     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00368}00368         return "{}Terminal"{};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00369}00369     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00370}00370 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00371}00371     \string~Terminal()}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00372}00372     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00373}00373         Serial.print("{}Deleting "{});}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00374}00374         Serial.println ((size\_t) this);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00375}00375     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00377}00377     int WaitForSerialData ()}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00378}00378     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00379}00379         int nChars = 0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00380}00380 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00381}00381         for (;(nChars = Serial.available ()) == 0; YieldNow ());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00382}00382 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00383}00383         return nChars;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00384}00384     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00385}00385 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00386}00386     bool ReadCommandLine (String\& readCommand)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00387}00387     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00388}00388         uint8\_t chChar = 0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00389}00389         int nChars = 0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00390}00390 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00391}00391         readCommand = "{}"{};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00392}00392 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00393}00393         while (nChars || (nChars = WaitForSerialData ()) > 0)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00394}00394         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00395}00395             chChar = Serial.read ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00396}00396 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00397}00397             if (chChar == TERMINAL\_BS \&\& readCommand.length () > 0)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00398}00398             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00399}00399                 Serial.print ((char)TERMINAL\_BS);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00400}00400                 Serial.print (' ');}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00401}00401                 Serial.print ((char)TERMINAL\_BS);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00402}00402 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00403}00403                 readCommand.remove (readCommand.length ()-\/1);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00404}00404             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00405}00405             else if (chChar == '\(\backslash\)r')}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00406}00406             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00407}00407                 Serial.println (F("{}"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00408}00408                 break;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00409}00409             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00410}00410             else if (chChar >= 32 \&\& chChar < 127)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00411}00411             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00412}00412                 Serial.print ((char)chChar);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00413}00413                 Serial.flush ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00414}00414                 Serial.flush ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00415}00415                 readCommand.concat ((char) chChar);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00416}00416             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00417}00417 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00418}00418             nChars-\/-\/;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00419}00419         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00420}00420 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00421}00421         if (! Serial)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00422}00422         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00423}00423             return false;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00424}00424         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00425}00425 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00426}00426         readCommand.trim();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00427}00427 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00428}00428         return true;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00429}00429     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00430}00430 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00431}00431     void run() noexcept override}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00432}00432     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00433}00433         size\_t nNotified=0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00434}00434 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00435}00435         for (;;)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00436}00436         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00437}00437             Yield ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00438}00438 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00439}00439             Serial.print (F("{}free:"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00440}00440             Serial.print (GetFreeRam ());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00441}00441             Serial.print (F("{} bytes, Robot>"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00442}00442             Serial.flush();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00443}00443 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00444}00444             if (ReadCommandLine (readCommand) \&\& readCommand != "{}"{})}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00445}00445             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00446}00446                 nDataCount++;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00447}00447 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00448}00448                 // SyncNotify System to execute a command}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00449}00449                 if ((nNotified = SyncNotify ((size\_t) terminalStatus::command, readCommand, 1, 1000)) == 0)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00450}00450                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00451}00451                     Serial.println (F("{}Terminal: System is BUSY, please try again."{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00452}00452                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00453}00453                 else}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00454}00454                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00455}00455                     // Wait the command to be executed, only a single notification is sent}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00456}00456                     if (Wait (readCommand, (size\_t) terminalStatus::done) == false)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00457}00457                     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00458}00458                         Serial.println (F("{}ERROR, Failed to query command completion."{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00459}00459                     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00460}00460                     else}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00461}00461                     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00462}00462                         Serial.println (F("{}Done"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00463}00463                     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00464}00464                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00465}00465             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00466}00466 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00467}00467             Serial.flush ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00468}00468 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00469}00469         \};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00470}00470     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00471}00471 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00472}00472     void StackOverflowHandler(void) noexcept final}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00473}00473     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00474}00474         PrintStackOverflow ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00475}00475     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00476}00476 \};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00477}00477 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00479}00479 // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00480}00480 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00481}00481 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00482}00482 /**}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00483}00483  * @brief SYSTEM THREAD}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00484}00484  *}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00485}00485  */}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00486}00486 class System : public atomicx}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00487}00487 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00488}00488 public:}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00489}00489     System(uint32\_t nNice) :  atomicx ()}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00490}00490     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00491}00491         SetNice(nNice);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00492}00492     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00493}00493 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00494}00494     const char* GetName () override}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00495}00495     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00496}00496         return "{}System"{};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00497}00497     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00498}00498 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00499}00499     \string~System()}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00500}00500     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00501}00501         Serial.print (F("{}Deleting Consumer: ID:"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00502}00502         Serial.println ((size\_t) this);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00503}00503     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00504}00504 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00505}00505     inline void ExecuteSystemCommand (String\& strCommand)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00506}00506     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00507}00507         ListAllThreads ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00508}00508 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00509}00509         Serial.println (F("{}[Motors] -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00510}00510 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00511}00511         for (int nCount=0; nCount < motorsContext; nCount++)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00512}00512         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00513}00513             Serial.print (F("{}Motor "{})); Serial.print ((char) ('A' + nCount));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00514}00514             Serial.print (F("{}: Enc: "{})); Serial.print (g\_motors[nCount].encoder);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00515}00515             Serial.print (F("{}, Mv: "{})); Serial.print (g\_motors[nCount].movement);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00516}00516             Serial.print (F("{}, Volts: "{})); Serial.print (g\_motors[nCount].volts);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00517}00517             Serial.print (F("{}v, Sts:"{})); Serial.println ((size\_t) g\_motors[nCount].status);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00518}00518         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00519}00519     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00520}00520 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00521}00521     inline void ExecuteMoveCommand (String\& strCommand)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00522}00522     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00523}00523         String strParam = F("{}"{});}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00524}00524         uint8\_t nParams = ParseOption (readCommand, 1, strParam, true);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00525}00525         size\_t nNofied = 0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00526}00526 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00527}00527         if (nParams == 5)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00528}00528         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00529}00529             ParseOption (readCommand, 1, strParam);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00530}00530             g\_motors[0].movement = strParam.toFloat();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00531}00531 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00532}00532             ParseOption (readCommand, 2, strParam);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00533}00533             g\_motors[1].movement = strParam.toFloat();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00534}00534 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00535}00535             ParseOption (readCommand, 3, strParam);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00536}00536             g\_motors[2].movement = strParam.toFloat();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00537}00537 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00538}00538             ParseOption (readCommand, 4, strParam);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00539}00539             g\_motors[3].movement = strParam.toFloat();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00540}00540 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00541}00541             /**}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00542}00542              * @brief   Instead of using SyncNotify que look for at least 1 Wait call blocked, it uses}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00543}00543              *          LookForWaitings to block until at least 4 threads are blocked Waiting}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00544}00544              */}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00545}00545             if (LookForWaitings (motorsContext, (size\_t) MotorStatus::request, 4, 10000))}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00546}00546             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00547}00547                 if ((nNofied = Notify ((size\_t) MotorStatus::moveRequest, motorsContext, (size\_t) MotorStatus::request, NotifyType::all)) == false)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00548}00548                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00549}00549                     Serial.println (F("{}ERROR, failed send command to all Motors"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00550}00550                     return;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00551}00551                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00552}00552             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00553}00553 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00554}00554             Serial.print (F("{}\(\backslash\)n\(\backslash\)nNotified motors: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00555}00555             Serial.print (nNofied);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00556}00556             Serial.print (F("{}, has:"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00557}00557             Serial.println (IsWaiting (motorsContext, (size\_t) MotorStatus::request));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00558}00558             Serial.flush ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00559}00559 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00560}00560             // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00561}00561             //Asynchronously wait for the motors to finish}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00562}00562             // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00563}00563 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00564}00564             uint8\_t nRspCounter=0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00565}00565             size\_t nMotorResponse=0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00566}00566 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00567}00567             if (nNofied == motorsContext)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00568}00568             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00569}00569                 while (nRspCounter < motorsContext)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00570}00570                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00571}00571                     if (Wait (nMotorResponse, motorsContext, (size\_t) MotorStatus::response, 1000))}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00572}00572                     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00573}00573                         Serial.print (F("{}>> Motor "{})); Serial.print ((char)('A' + (char) nMotorResponse));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00574}00574                         Serial.println (F("{}: Reported completion. "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00575}00575                         Serial.flush ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00576}00576 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00577}00577                         nRspCounter++;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00578}00578                     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00579}00579                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00580}00580             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00581}00581             else}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00582}00582             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00583}00583                 ListAllThreads ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00584}00584             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00585}00585         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00586}00586         else}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00587}00587         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00588}00588             Serial.println (F("{}MOVE: Please use move motorA motorB motorC motorD"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00589}00589             Serial.println (F("{}ERROR"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00590}00590         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00591}00591     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00592}00592 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00593}00593     inline void ExecuteCommand(String\& strCommand, uint8\_t\& nCommandCode)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00594}00594     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00595}00595         switch (nCommandCode)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00596}00596         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00597}00597             case (uint8\_t) TerminalCommands::system:}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00598}00598                 ExecuteSystemCommand (strCommand);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00599}00599                 break;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00600}00600 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00601}00601             case (uint8\_t) TerminalCommands::move:}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00602}00602                 ExecuteMoveCommand (strCommand);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00603}00603                 break;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00604}00604 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00605}00605             default:}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00606}00606                 Serial.println (F("{}Command not implemented."{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00607}00607         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00608}00608 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00609}00609         return;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00610}00610     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00611}00611 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00612}00612     void UpdateMotorVoltages(void)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00613}00613     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00614}00614         for (int nCount=0; nCount < motorsContext; nCount++)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00615}00615         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00616}00616             g\_motors[nCount].volts = static\_cast<float>(random (2000, 2700)) / 100.0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00617}00617         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00618}00618     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00619}00619 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00620}00620     void run() noexcept override}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00621}00621     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00622}00622         size\_t nCount=0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00623}00623         size\_t nMessage = 0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00624}00624 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00625}00625         for (;;)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00626}00626         \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00627}00627             Yield ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00628}00628 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00629}00629             if (Wait (nMessage, readCommand, 1, GetNice ()))}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00630}00630             \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00631}00631                 if (nMessage == (size\_t) terminalStatus::command)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00632}00632                 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00633}00633                     String strCommandName = F("{}"{});}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00634}00634                     auto numParams = ParseOption (readCommand, 0, strCommandName, true);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00635}00635                     ParseOption (readCommand, 0, strCommandName);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00636}00636                     auto nCommandCode = ConvertStrCommand (strCommandName);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00637}00637 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00638}00638                     Serial.print (F("{}System thread ID:"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00639}00639                     Serial.print (GetID());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00640}00640                     Serial.print (F("{}, Num Params: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00641}00641                     Serial.print (numParams);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00642}00642                     Serial.print (F("{}, Command: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00643}00643                     Serial.print (strCommandName);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00644}00644                     Serial.print (F("{}("{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00645}00645                     Serial.print ((int)nCommandCode);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00646}00646                     Serial.print (F("{}), Message: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00647}00647                     Serial.println (readCommand);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00648}00648 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00649}00649                     if (nCommandCode > 0)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00650}00650                     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00651}00651                         ExecuteCommand (readCommand, nCommandCode);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00652}00652                     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00653}00653                     else}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00654}00654                     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00655}00655                         Serial.print (F("{}Command, "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00656}00656                         Serial.print (strCommandName);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00657}00657                         Serial.println (F("{}, is not valid."{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00658}00658                     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00659}00659 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00660}00660                     if (SyncNotify (readCommand, (size\_t) terminalStatus::done, 1000) == 0)}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00661}00661                     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00662}00662                         Serial.println (F("{}Error, Terminal not responding. Please check."{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00663}00663                     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00664}00664                 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00665}00665 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00666}00666                 Serial.flush ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00667}00667             \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00668}00668         \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00669}00669     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00670}00670 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00671}00671     void StackOverflowHandler(void) noexcept final}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00672}00672     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00673}00673         PrintStackOverflow ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00674}00674     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00675}00675 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00676}00676 \};}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00677}00677 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00678}00678 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00679}00679 // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00680}00680 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00681}00681 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00682}00682 void ListAllThreads()}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00683}00683 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00684}00684     size\_t nCount=0;}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00685}00685 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00686}00686     Serial.flush();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00687}00687 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00688}00688     Serial.println (F("{}\(\backslash\)e[K[THREAD]-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00689}00689 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00690}00690     Serial.print (F("{}\(\backslash\)e[K>>> Free RAM: "{})); Serial.println (GetFreeRam());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00691}00691     Serial.print (F("{}\(\backslash\)e[KAtomicX context size: "{})); Serial.println (sizeof (atomicx));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00692}00692     Serial.print (F("{}\(\backslash\)e[KTerminal Context:"{})); Serial.println (sizeof (Terminal));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00693}00693     Serial.print (F("{}\(\backslash\)e[KMotor Context:"{})); Serial.println (sizeof (Motor));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00694}00694     Serial.print (F("{}\(\backslash\)e[KSystem Context:"{})); Serial.println (sizeof (System));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00695}00695 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00696}00696     Serial.println ("{}\(\backslash\)e[K-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{});}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00697}00697 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00698}00698     for (auto\& th : *(atomicx::GetCurrent()))}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00699}00699     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00700}00700         Serial.print (F("{}\(\backslash\)e[K"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00701}00701         Serial.print (atomicx::GetCurrent() == \&th ? F("{}*  "{}) : F("{}   "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00702}00702         Serial.print (++nCount);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00703}00703         Serial.print (F("{}:'"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00704}00704         Serial.print (th.GetName());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00705}00705         Serial.print (F("{}' "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00706}00706         Serial.print ((size\_t) th.GetID());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00707}00707         Serial.print (F("{}\(\backslash\)t| Nice: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00708}00708         Serial.print (th.GetNice());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00709}00709         Serial.print (F("{}\(\backslash\)t| Stack: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00710}00710         Serial.print (th.GetStackSize());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00711}00711         Serial.print ("{}\(\backslash\)t| UsedStack: "{});}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00712}00712         Serial.print (th.GetUsedStackSize());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00713}00713         Serial.print (F("{}\(\backslash\)t\(\backslash\)t| Stat: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00714}00714         Serial.print (th.GetStatus());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00715}00715         Serial.print (F("{}\(\backslash\)t| SStat: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00716}00716         Serial.print (th.GetSubStatus());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00717}00717         Serial.print (F("{}\(\backslash\)t| LstExecTime: "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00718}00718         Serial.print (th.GetLastUserExecTime());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00719}00719         Serial.println (F("{}ms"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00720}00720         Serial.flush(); Serial.flush();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00721}00721     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00722}00722 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00723}00723     Serial.println ("{}\(\backslash\)e[K-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{});}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00724}00724     Serial.flush();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00725}00725 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00726}00726 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00727}00727 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00728}00728 // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00729}00729 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00730}00730 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00731}00731 void setup()}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00732}00732 \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00733}00733     Serial.begin (115200);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00734}00734 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00735}00735     while (! Serial) delay (100);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00736}00736 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00737}00737     // if analog input pin 0 is unconnected, random analog}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00738}00738     // noise will cause the call to randomSeed() to generate}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00739}00739     // different seed numbers each time the sketch runs.}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00740}00740     // randomSeed() will then shuffle the random function.}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00741}00741     randomSeed(analogRead(0));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00742}00742 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00743}00743     //MOTD}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00744}00744     \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00745}00745         delay (1000);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00746}00746         Serial.println (F("{}\(\backslash\)n\(\backslash\)n"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00747}00747         Serial.println (F(ATOMIC\_VERSION\_LABEL));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00748}00748         Serial.println (F("{}\(\backslash\)n Starting Up...."{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00749}00749         delay (500);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00750}00750 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00751}00751         Serial.println (F("{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00752}00752         Serial.println (F("{} ATOMICX DEMO FOR ROBOT CONTROL SYSTEM "{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00753}00753         Serial.print (F("{}FREE RAM: "{})); Serial.println (GetFreeRam ());}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00754}00754         Serial.println (F("{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n"{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00755}00755 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00756}00756         Serial.flush();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00757}00757     \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00758}00758 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00759}00759     System systemThread (100);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00760}00760 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00761}00761     Terminal terminalThread (0);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00762}00762 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00763}00763     Motor motorsThreadA (200, 'A', g\_motors[0], dirA, stepA);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00764}00764     Motor motorsThreadB (200, 'B', g\_motors[1], dirX, stepX);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00765}00765     Motor motorsThreadC (200, 'C', g\_motors[2], dirY, stepY);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00766}00766     Motor motorsThreadD (200, 'D', g\_motors[3], dirZ, stepZ);}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00767}00767 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00768}00768     atomicx::Start();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00769}00769 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00770}00770     Serial.println (F("{}Full lock detected..."{}));}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00771}00771 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00772}00772     ListAllThreads ();}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00773}00773 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00774}00774 \}}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00775}00775 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00776}00776 void loop() \{}
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00777}00777 }
\DoxyCodeLine{\Hypertarget{avr_auto_robot_controller_8ino_source_l00778}00778 \}}

\end{DoxyCode}
